
# Позитивные тест-кейсы — Warehouse API

Документ содержит описание позитивных тест-кейсов для каждого метода из Swagger UI.

---

## Products (warehouse-controller)

### 1. POST /products/products — Создать товар
**Предусловия:** сервис запущен.  
**Шаги:**
1. Отправить POST-запрос с телом:
   ```json
   {
     "name": "Apple",
     "article": "<UUID>",
     "category": "VEGETABLES",
     "dictionary": "test",
     "price": 10,
     "qty": 5
   }
````

2. Проверить код ответа.
3. Сохранить `id` товара.

**Ожидаемый результат:**

* Код 200/201.
* В ответе JSON с полем `id`.
* Поля совпадают с переданными.

---

### 2. GET /products — Получить список товаров

**Предусловия:** существует товар с id.
**Шаги:**

1. Отправить GET-запрос `/products`.
2. Найти созданный ранее товар в массиве.

**Ожидаемый результат:**

* Код 200.
* В списке есть товар с нужным `id`.

---

### 3. PATCH /products — Обновить товар

**Предусловия:** существует товар с id.
**Шаги:**

1. Отправить PATCH-запрос с телом:

   ```json
   {
     "id": "<id>",
     "name": "Apple Green",
     "price": 12,
     "qty": 7
   }
   ```
2. Проверить код ответа.

**Ожидаемый результат:**

* Код 200/204.
* Повторный GET `/products/{id}` возвращает обновлённые данные.
* Поле `last_qty_changed` присутствует при изменении `qty`.

---

### 4. GET /products/{id} — Получить товар по ID

**Предусловия:** существует товар с id.
**Шаги:**

1. Отправить GET-запрос `/products/{id}`.
2. Проверить поля.

**Ожидаемый результат:**

* Код 200.
* Верные поля товара.

---

### 5. DELETE /products/{id} — Удалить товар

**Предусловия:** товар существует.
**Шаги:**

1. Отправить DELETE-запрос `/products/{id}`.
2. Проверить код ответа.
3. Повторно запросить GET `/products/{id}`.

**Ожидаемый результат:**

* Код 200/204.
* Повторный GET возвращает ошибку (400/404/410).

---

## Orders (order-controller)

### 6. POST /order — Создать заказ

**Предусловия:** существует активный клиент (`customer_id`), есть доступный товар.
**Шаги:**

1. Создать товар через `POST /products/products`.
2. Отправить POST `/order` с заголовком `customer_id` и телом:

   ```json
   {
     "deliveryAddress": "Test street",
     "products": [{ "id": "<product_id>", "qty": 3 }]
   }
   ```
3. Сохранить `orderId`.

**Ожидаемый результат:**

* Код 200/201.
* В ответе JSON (или plain text) с id заказа.
* Заказ создан, рассчитан `totalPrice`.

---

### 7. GET /order/{id} — Получить заказ

**Предусловия:** заказ создан.
**Шаги:**

1. Отправить GET `/order/{id}` с заголовком `customer_id`.

**Ожидаемый результат:**

* Код 200.
* Верный заказ, список продуктов, поле `totalPrice`.

---

### 8. PATCH /order/{id} — Редактировать заказ

**Предусловия:** заказ создан.
**Шаги:**

1. Отправить PATCH `/order/{id}` с телом:

   ```json
   {
     "products": [{ "id": "<product_id>", "qty": 5 }]
   }
   ```
2. Проверить код ответа.
3. Повторить GET `/order/{id}`.

**Ожидаемый результат:**

* Код 200/204.
* В заказе обновлён qty.
* `totalPrice` пересчитан.

---

### 9. DELETE /order/{id} — Удалить заказ

**Предусловия:** заказ создан.
**Шаги:**

1. Отправить DELETE `/order/{id}` с заголовком `customer_id`.
2. Проверить код ответа.
3. Повторить GET `/order/{id}`.

**Ожидаемый результат:**

* Код 200/204.
* Заказ отменён или не доступен.

